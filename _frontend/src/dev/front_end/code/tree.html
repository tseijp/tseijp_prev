
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript">

// this code is from https://...

var branch = [];
var offset = -90.0;
var count;
var s_color;
var s_weight;
function setup () {
	pixelDensity (displayDensity ());
	createCanvas (innerWidth, innerHeight);
	background (255);
	colorMode (RGB, 255, 255, 255, 100);
	branch.push (new CreateBranch (width / 2, height, width / 2, height - 80.0, 80.0, 0.0));
	count = 0;
	s_color = 0;
	s_weight = 0;
}
function draw () {
	for (var i = 0; i < branch.length; i++) {
		branch[i].render ();
		branch[i].update ();
	}
}
function CreateBranch (sx, sy, ex, ey, sl, sd) {
	var startx = sx; var endx = ex; var length = sl;
	var starty = sy; var endy = ey; var degree = sd;
	var nextx = startx; var prevx = startx;var next_flag = true;
	var nexty = starty; var prevy = starty;var draw_flag = true;
	this.update = function () {
		nextx   += (endx - nextx) * 0.4;
		nexty   += (endy - nexty) * 0.4;
		s_color  = int (count / 10.0);
		s_weight = 3.0 / (count / 100 + 1);
		if (abs (nextx - endx) < 1.0 && abs (nexty - endy) < 1.0 && next_flag == true) {
			next_flag = false;nextx = endx;
			draw_flag = false;nexty = endy;
			var num = int (random (2, 4));
			for (var i = 0; i < num; i++) {
				var sx = endx;
				var sy = endy;
				var sl = random (random (10.0, 20.0), length * 0.99);
				var sd = random (-24.0, 24.0);
				var ex = sx + sl * cos (radians (sd + degree + offset));
				var ey = sy + sl * sin (radians (sd + degree + offset));
				branch.push (new CreateBranch (sx, sy, ex, ey, sl, sd + degree));
			}
			count += 1;
		}
		if (branch.length > 20000) {
			count = 0;
			s_color = 0;
			s_weight = 0;
			var sx = random (width);
			var sl = random (0.0, 180.0);
			branch = [];
			branch.push (new CreateBranch (sx, height, sx, height - sl, sl, 0.0));
		}
	}
	this.render = function () {
		if (draw_flag == true) {
			stroke (50, s_color/3, 0);
			strokeWeight (s_weight);
			line (prevx, prevy, nextx, nexty);
		}
		prevx = nextx;
		prevy = nexty;
	}
}
function windowResized(){
  resizeCanvas(innerWidth, innerHeight);
  background (255);
}
function mousePressed(){
  branch.push (new CreateBranch (mouseX, height, mouseX, mouseY, 80.0, 0.0));
}
    </script>

    <style>
        body {
            margin: 0;
            height: 0;
            overflow: hidden;
        }
        canvas {
            width: 100vw;
            height: 100vh;
            background: black;
        }

    </style>
  </head>
  <body>
    <div id="p5Canvas_1"></div>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.2/p5.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.2/addons/p5.dom.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.2/addons/p5.sound.min.js"></script>

  </body>
</html>
